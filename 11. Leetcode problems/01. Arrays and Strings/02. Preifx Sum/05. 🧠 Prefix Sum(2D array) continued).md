## How to create a 2D prefix sum array? and how to use it to perfrom range queries?

---

## Original 3Ã—3 Matrix

```
matrix =
[
  [1, 2, 3],
  [4, 5, 6],
  [7, 8, 9]
]
```

---

## What a 2D Prefix Sum Matrix Stores

`ps[r][c]` = sum of **all elements from (0,0) to (r,c)** inclusive.

---

## Step-by-Step Construction

### Cell (0,0)

```
ps[0][0] = 1
```

---

### Cell (0,1)

```
ps[0][1] = 1 + 2 = 3
```

---

### Cell (0,2)

```
ps[0][2] = 1 + 2 + 3 = 6
```

---

### Cell (1,0)

```
ps[1][0] = 1 + 4 = 5
```

---

### Cell (1,1)

```
ps[1][1] =
    matrix[1][1]
  + ps[0][1]
  + ps[1][0]
  - ps[0][0]

= 5 + 3 + 5 - 1 = 12
```

---

### Cell (1,2)

```
ps[1][2] =
    6 + ps[0][2] + ps[1][1] - ps[0][1]
= 6 + 6 + 12 - 3 = 21
```

---

### Cell (2,0)

```
ps[2][0] = 1 + 4 + 7 = 12
```

---

### Cell (2,1)

```
ps[2][1] =
    8 + ps[1][1] + ps[2][0] - ps[1][0]
= 8 + 12 + 12 - 5 = 27
```

---

### Cell (2,2)

```
ps[2][2] =
    9 + ps[1][2] + ps[2][1] - ps[1][1]
= 9 + 21 + 27 - 12 = 45
```

---

## Final Prefix Sum Matrix

```
ps =
[
  [ 1,  3,  6],
  [ 5, 12, 21],
  [12, 27, 45]
]
```

---

## How to Use It (Quick Example)

### Query: sum of submatrix (1,1) â†’ (2,2)

Submatrix:

```
[
  [5, 6],
  [8, 9]
]
```

Sum = `5 + 6 + 8 + 9 = 28`

### Using prefix sum:

```
sum =
  ps[2][2]
- ps[0][2]
- ps[2][0]
+ ps[0][0]

= 45 - 6 - 12 + 1 = 28 âœ…
```

---

## Key Takeaway ðŸ§ 

* Each prefix cell stores **total area from top-left**
* Inclusionâ€“exclusion removes extra regions
* Once built â†’ **any rectangle sum in O(1)**